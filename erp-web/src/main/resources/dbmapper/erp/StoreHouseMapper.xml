<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.skyeye.dao.StoreHouseDao">

    <select id="queryStoreHouseByList" parameterType="java.util.Map" resultType="java.util.Map">
        SELECT
            d.id,
            d.`name` houseName,
            d.address,
            d.warehousing,
            d.truckage,
            d.remark,
            d.principal,
            d.tenant_id,
            d.is_default isDefault,
            CONVERT (d.create_time, CHAR) createTime
        FROM
            erp_depot d
        WHERE
            d.delete_Flag = 0
        <if test="name != '' and name != null">
            AND d.name LIKE '%${name}%'
        </if>
        ORDER BY d.create_time DESC
    </select>

    <select id="queryStoreHouseByName" parameterType="java.util.Map" resultType="java.util.Map">
        SELECT
            d.id,
            d.`name` houseName
        FROM
            erp_depot d
        WHERE
            d.name = #{name}
        AND
            d.delete_Flag = 0
        ORDER BY d.create_time DESC LIMIT 0,1
    </select>

    <insert id="insertStoreHouse" parameterType="java.util.Map">
        INSERT into erp_depot(
            id,
	        name,
	        <if test="address != '' and address != null">
	            address,
            </if>
            <if test="warehousing != '' and warehousing != null">
                warehousing,
            </if>
            <if test="truckage != '' and truckage != null">
                truckage,
            </if>
	        <if test="remark != '' and remark != null">
                remark,
            </if>
            <if test="principal != '' and principal != null">
                principal,
            </if>
        tenant_id,
        is_default,
        create_time
        )VALUES(
        #{id},
        #{name},
        <if test="address != '' and address != null">#{address},
        </if>
            <if test="
        warehousing != '' and warehousing != null">
                #{warehousing},
            </if>
            <if test="truckage != '' and truckage != null">
                #{truckage},
            </if>
            <if test="remark != '' and remark != null">
                #{remark},
            </if>
            <if test="principal != '' and principal != null">
                #{principal},
            </if>
	        #{tenantId},
	        #{is_default},
	        #{createTime}
        )
    </insert>

    <select id="queryStoreHouseById" parameterType="java.util.Map" resultType="java.util.Map">
        SELECT
            d.id,
            d.`name` houseName,
            d.address,
            d.warehousing,
            d.truckage,
            d.remark,
            d.principal,
            d.tenant_id,
            d.is_default isDefault,
            CONVERT (d.create_time, CHAR) createTime
        FROM
            erp_depot d
        WHERE
            d.id = #{id}
        AND
            d.tenant_id = #{userId}
        ORDER BY d.create_time DESC LIMIT 0,1
    </select>

    <update id="editStoreHouseById" parameterType="java.util.Map">
        UPDATE erp_depot
        <set>
            <if test="address != '' and address != null">
                address = #{address},
            </if>
            <if test="warehousing != '' and warehousing != null">
                warehousing = #{warehousing},
            </if>
            <if test="truckage != '' and truckage != null">
                truckage = #{truckage},
            </if>
            <if test="remark != '' and remark != null">
                remark = #{remark},
            </if>
            <if test="principal != '' and principal != null">
                principal = #{principal},
            </if>
            <if test="delete_Flag !='' and delete_Flag != null">
                delete_Flag = #{delete_Flag},
            </if>
            <if test="is_default != '' and is_default != null">
                is_default = #{is_default},
            </if>
            <if test="name != '' and name != null">
                name = #{name},
            </if>
        </set>
        WHERE
            id = #{id}
        AND
            tenant_id = #{userId}
    </update>

    <update id="editStoreHouseBydeleteFlag" parameterType="java.util.Map">
        UPDATE erp_depot
        <set>
            delete_Flag = #{delete_Flag}
        </set>
        WHERE
          id = #{id}
        AND
          tenant_id = #{userId}
    </update>

    <update id="editStoreHouseByDefault" parameterType="java.util.Map">
        UPDATE erp_depot
        <set>
            is_default = #{is_default}
        </set>
        WHERE
          id = #{id}
        AND
          tenant_id = #{userId}
    </update>
</mapper>